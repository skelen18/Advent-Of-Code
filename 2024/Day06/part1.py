def simulate_guard_path(grid):
    grid = [list(row) for row in grid.strip().split("\n")]
    rows, cols = len(grid), len(grid[0])
    directions = {"^": (-1, 0), ">": (0, 1), "v": (1, 0), "<": (0, -1)}  
    direction_order = ["^", ">", "v", "<"]  
    guard_position = None
    guard_direction = None

    for r in range(rows):
        for c in range(cols):
            if grid[r][c] in directions:
                guard_position = (r, c)
                guard_direction = grid[r][c]
                break
        if guard_position:
            break

    if not guard_position:
        raise ValueError("Počáteční pozice stráže nebyla nalezena!")

    visited_positions = set()
    r, c = guard_position
    dr, dc = directions[guard_direction]

    while 0 <= r < rows and 0 <= c < cols:
        visited_positions.add((r, c))
        next_r, next_c = r + dr, c + dc
        if 0 <= next_r < rows and 0 <= next_c < cols and grid[next_r][next_c] == "#":
            current_direction_index = direction_order.index(guard_direction)
            guard_direction = direction_order[(current_direction_index + 1) % 4]  
            dr, dc = directions[guard_direction]
        else:
            r, c = next_r, next_c

    return len(visited_positions)

input_map = """
..............................#....#..........................................#....................#...........#..##..............
.......#............................#..........#...................................................#...................#........#.
......................................#..................#.................#....................................#...#............#
........#...................#.....................................................................................#...............
.............................#........................#.......................#........#............................#.............
........................##......................................#...............#...................................#.............
...#................#.......................#....#........................#.............................#.........................
..............................................................#............##......#.......#..#.....................#.....#.......
.........................#..#............##.......#.........#....................#.......................##...............#....#..
..............#....................................................................#....#........................................#
.................#............#.....#.....#............................................................#......................#...
.#.................#.................#.....................................#......................................................
...........##..#.......#.........#.#......#..................#.....................#.....#........................................
....................................................#........#........#....................................#......................
........#........#..........#..........................................................#.##.........#..........................#..
...........#............................#............##.............................#...............................#............#
............#......#...............#...........#................................................#.................................
............#..#.#......#............................................................................#.##....#............#.......
................#..............#......#...#........................#.......#.........................#............................
..........................................................................#............#........#......#.#......#.............#...
..........#...#...........................................................#......#..........................................#.....
.......................................#....#..............#...............#....#............#.............#......................
...........#............................................#................................#..............#.........................
..##...............#.................................................................................#.......#.........#.........#
..........#......#......#.........................................#..........#...##.................................#........#....
..........#.......................................................................#..........#...............##.#....#............
....#.............#..#......#..........................................................#......................#...................
.......................................................................#.............##......................#............#.......
............#..#.........#...............................................................................#........................
...............##..#..................#....#....................................................................#......#..........
......#...............................................................................#..#...............#........................
.....#............................................................................#...............#......#........................
#.......................#.........................#...........#....#...#.......#..................................................
.#....................#..............#........................#....................#........###............#.#.#............#.....
.......#...#...................#................................................................................#........##.......
............#.................#.........................................#.....................................#...................
..................#...........#...................................................................................................
......................#.......#...............................#......#...........................#..................#.............
...#..........#......#..........#.....................................................#.....#.................................#...
......#.......#..............................#..............#...............................#...............................#.....
....................................................................#..........#.....#.#...#................................#.....
..............................#...#.....................##.........................................#.#...................#........
........................#....#..............#....................................................................................#
............................#......##...........................#...........#...............................#.....................
.....................................................................................#............................................
#.....................#.................#...#.......##....................#.##.....#.#.......................#....................
....................#............................#.............................................................................#..
........................#.....................................#.............#..............#......................................
...............#....#...................#............................#..#...#.....................................................
.#...........#......#...........##.#...........^.....#........................#..........#.................#......................
...#.##.........#.#......................................#...............#............#......#....................................
.....................................................#......................#.........#.......................#...................
............................................##............#....................#............................#.....................
.............................#.........................##.............#...........................................................
........................................#.............................................................................#...........
.........................................#...............#........#..........................#.#........................#.........
............................................#.................#...............................#...........#.#.......#.............
....................#.............#.........................#..........................#............................#.............
.#.................................#..........#..#.......................................................#........................
..................#..............................................#............##.....#......................................#..#..
.......#...........................................#..................#...........................................................
.#.................................................................#....................................................#.........
...........#.#........#....#...............#.........................................#........................#.........#.........
...............#......#...........#....#....#...............................#..#......#........#.....................#......#.....
.......................................................#.........#.............................#..................#...............
#........................#.........#..........................#................................#...#.....................#.......#
.............................#....................................................................................................
...#..................#....#.............................................................................................#........
..................#........#...............#............................................#..........#..#........................#..
..#...................#..................................#.......#......................#.................................#......#
.........................................#.#......##..........................#.........#..#....................................#.
..........#....#............#.....##....................................................................................#.........
.....#.........##.................................................................................................................
.............................................................................................................#.............#......
...........#.......#..............#...#............#.......................#...#......#.....................................#.....
.......#...................#...........#.....#...#..........................#...........#.........#.............................#.
..............#.....................#..........................................................#..................................
..#............#.................................................#.....#.....................#....#.............................#.
.................#..................................#....#...............................#........................................
.......#..#...........#.#..........##.#.#......................................##.#.....................................#....#....
.....#.#...#......#.............................................................#.........#..#.....................#.............#
.....................................................#..........................................#.......................#.........
........................#....................#................................#......#...........................#......#.........
..........#...........................................................#.....#.#....#...............................#...........#..
........#...............#..............#......#..............................................................#.............#......
...................................................................................................................#..............
.....#..................................................................................##...................#.......#.....#......
...#..#..............#....................................#..#.#..........#.......................................................
#..................#......##.......#..............................................................................................
........................................#....#.........................................................................#..........
#.................................#...................................................#.........#.#...............................
..........................#.....#.#.....................#..........#...................#..#...........................#.....#.....
..........................#..............................#.......#................................................................
.........................#............................#.........#.........#............#............#.#..........................#
.#.#.....................#.....................................#............#.........#..........#.............#.................#
.........#..........................................#.........................................................#...................
..........................................................#.........................#....#...#......#........................#....
.......#.#.........#.............................................#.................#...................#.................#.#......
............#..#........#..#...........#.........................................................#..............#...#.............
..........................#..............#...................................................................#....................
......#.....................#...............#......................................#......#.................#.....................
.........................................................................#.#...........................#..#....#..................
...........#.............................#...#....#...............................................................................
.................................#.....#...............#....#.#.....................................#.........................#...
.#.......#..............#....#..............................................................................#...............##....
.................................#............................#................#...#.........#...................................#
...........#......#.......#..............#.........................#.#.....................................#.......#..............
.....................#....................................#...................#...................................................
...........#...................#.....................................................................................#........#...
..................#...#....................................................................................#..#.........#.........
.............#.................................................#.........#.#.#...............................................#....
..................#............................................#.......................................................#..........
..#......#...........#............................................#...........#............#......#.....................#.........
......#.......................##..........#................................................#...................................#..
.......................................................................#.........#........#....#........................#......#..
..........#...........#...#....................................#.#.............#.#............................#...#.....#.........
.##...............................#......#.....................................................#.........................#......#.
.#.#...#.................................................#......#....................#...........................................#
.........................#..................#.............................#......................................#................
...................................#.......................#..................................#.........#.........................
.........................#...........#...............#........#..................................#...........#..............#.....
...............................#.......................................#.......#.....#.................#....#..............#......
...#...........#.....#................................................#..................#........#.............................#.
..............#........#................................#...#................................#.......#.......#........#........#..
......#....#...................................#............#.........#..#.##..................##....................#......#.....
.....#...........................#................##.............#.#...........................................#..................
#....................................................................#..#......................#..........#.......................
...........#...#..............#.........#....................#.....................#........#.......#...#.#............#..........
.......#..............#........#..##............#...............#.............#.#.......................#.#......#....#...........
....#........#..................#...............#....................#...#...............................#..........#....#..##....
"""

result = simulate_guard_path(input_map)
print("Part 1:", result)